# DS Markets

## Εκτέλεση συστήματος
Για να εκετελέσει κάποιος στον υπολογιστή του το συγκεκριμένο σύστημα θα πρέπει να έχει εγκαταστήσει το Docker και το Docker Compose.

### Docker
Το Docker είναι ένα εργαλείο που χρησιμοποιείται για να διευκολύνει και να απλοποιήσει τη διαδικασία της ανάπτυξης και εκτέλεσης εφαρμογών, μέσα από τη χρήση container.

#### Απαιτήσεις συστήματος
* 64-bit processor με Second Level Address Translation (SLAT)
* 4GB system RAM
* BIOS-level hardware virtualization support πρέπει να είναι ενεργοποιημένο στις ρυθμίσεις του BIOS (συνήθως είναι ήδη activated)

#### Εγκατάσταση στα Windows
* Windows 10 64-bit: Pro, Enterprise, or Education (Build 15063 or later).
* Πρέπει επίσης να είναι ενεργοποιημένα τα: 
  * Hyper-V 
  * Containers Windows Features
* Μπορείτε να κατεβάσετε το εκτελέσιμο αρχείο για την εγκατάσταση του Docker από εδώ : [Docker Desktop for Windows](https://hub.docker.com/editions/community/docker-ce-desktop-windows/)

#### Εγκατάσταση στα Linux (Ubuntu)
Αρκεί να εκτελέσετε τις παρακάτω εντολές στο terminal : 
1. `sudo apt-get update`
2. `sudo apt install -y apt-transport-https ca-certificates curl software-properties-common`
3. `curl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo apt-key add -`
4. `sudo add-apt-repository -y "deb [arch=amd64] https://download.docker.com/linux/ubuntu $(lsb_release -cs) stable"`
5. `sudo apt-get update`
6. `sudo apt install docker-ce`

### Docker Compose
Το Docker Compose είναι ένα εργαλείο για να ορίσουμε και να τρέξουμε πολλά containers μαζί.

#### Απαιτήσεις συστήματος
Το Docker Compose βασίζεται στο Docker Engine, οπότε αρκεί να έχετε εγκαταστήσει το Docker Engine τοπικά ή απομακρυσμένα.

#### Εγκατάσταση στα Windows και Mac 
Το docker-compose υπάρχει ήδη στα Docker για Windows και Mac.

#### Εγκατάσταση στα Linux (Ubuntu)
1. `sudo curl -L "https://github.com/docker/compose/releases/download/1.27.3/docker-compose-$(uname -s)-$(uname -m)" -o /usr/local/bin/docker-compose` (Η εντολή σε μία γραμμή!)
2. `sudo chmod +x /usr/local/bin/docker-compose`

### Containerization
Το Containerization ορίζεται ως μια μορφή εικονικοποίησης του λειτουργικού συστήματος, μέσω της οποίας οι εφαρμογές εκτελούνται σε απομονωμένο περιβάλλον χρήστη που ονομάζονται container.

Για να δημιουργήσει το Docker μια containerized εκδοχή της εφαρμογής μας που θα αλληλεπιδρά με την MongoDB θα πρέπει να εκτελέσετε αυτήν την εντολή στο terminal στο path του φακέλου του συστήματος :
* `(sudo) docker-compose up -d`

Αν θέλετε να σταματήσετε την εφαρμογή, εκτελέστε αυτήν την εντολή έτσι ώστε το Docker να σταματήσει τα container :
* `(sudo) docker-compose down`
 
## Λειτουργίες συστήματος
Εδώ θα αναφερθούν όλες οι δυνατότητες του συστήματος.
Στο σύστημα αυτό υπάρχουν δύο κατηγορίες χρηστών: (i) οι διαχειριστές, και (ii) οι απλοί χρήστες.
Πριν την εκτέλεση των λειτουργιών που περιγράφονται παρακάτω, οι χρήστες του συστήματος θα πρέπει να κάνουν εγγραφή στο σύστημα. Η εγγραφή θα επιτρέπει την εισαγωγή νέων χρηστών στο σύστημα οι οποίοι θα κατατάσσονται στη κατηγορία «Απλός Χρήστης».
Για να κάνει εγγραφή ένας χρήστης στο σύστημα, θα πρέπει να επισκεφθεί την διεύθυνση http://127.0.0.1:5000/register όπου εκεί θα δει μια φόρμα που θα του ζητούνται όνομα, email και κωδικός. Μπορεί να κάνει εγγραφή στο σύστημα αν και μόνο αν δεν υπάρχει ήδη άλλος χρήστης με το ίδιο email.
 
### Λειτουργίες απλού χρήστη
#### Είσοδος στο σύστημα
Ο χρήστης για να συνδεθεί, θα πρέπει να επισκεφθεί την διεύθυνση http://127.0.0.1:5000/login όπου εκεί θα δει μια φόρμα που θα του ζητούνται email και κωδικός. Αν εισάγει τα στοιχεία του λάθος θα του εμανιστεί μήνυμα "Wrong username or password, please try again", ενώ αν τα εισάγει σωστά, το σύστημα θα του εμφανίσει ένα uuid, το οποίο θα τον βοηθήσει να έχει πρόσβαση σε όλες τις λειτουργίες ενός απλού χρήστη. Αν προσπαθήσει με αυτό το uuid να αποκτήσει πρόσβαση σε σελίδα που προορίζεται μόνο για διαχειριστές, θα του εμφανιστεί μήνυμα "Only admins can perform this operation".

#### Αναζήτηση προϊόντος
Ο χρήστης για να αναζητήσει τα προϊόντα που περιλαμβάνει η βάση δεδομένων του συστήματος θα πρέπει να επισκεφθεί την διεύθυνση http://127.0.0.1:5000/uuid/searchProducts (όπου uuid είναι το uuid που του έδωσε το σύστημα όταν συνδέθηκε) και θα του εμφανίζεται μια φόρμα όπου θα του δίνεται η δυνατότητα να αναζητήσει προϊόντα με βάσει είτε το όνομά τους ή είτε την κατηγορία που ανήκουν ή είτε με βάσει τον μοναδικό κωδικό τους (εδώ χρησιμοποιήθηκε το _id το οποίο προσθέτει η MongoDB). Ειδικότερα, όσον αφορά την αναζήτηση των προϊόντων με βάσει το όνομα, τα προϊόντα που εμφανίζονται στον χρήστη είναι ταξινομημένα βάσει αλφαβητικής σειράς. Ενώ, όσον αφορά την αναζήτηση των προϊόντων με βάσει την κατηγορία που ανήκουν, τα προϊόντα που εμφανίζονται στον χρήστη είναι ταξινομημένα βάσει τιμής. Για κάθε προϊόν, εμφανίζονται στον χρήστη ο μοναδικός κωδικός του, το όνομά του, η τιμή του (σε €), η περιγραφή του και η κατηγορία που ανήκει. Ο χρήστης θα μπορεί να κάνει αναζήτηση με μόνο μια επιλογή κάθε φορά αλλιώς θα του εμφανίζεται μήνυμα "Only one field at the time".
  
#### Προσθήκη προϊόντων στο καλάθι
Ο χρήστης για να προσθέσει προϊόντα στο καλάθι του θα πρέπει να επισκεφθεί την διεύθυνση http://127.0.0.1:5000/uuid/addToCart/id/stock (όπου uuid είναι το uuid που του έδωσε το σύστημα όταν συνδέθηκε, id είναι ο μοναδικός κωδικός του προϊόντος και stock είναι η ποσότητα που επιθυμεί να προσθέσει) και θα του εμφανίζεται το καλάθι με όλα τα προϊόντα που έχει προσθέσει. Γίνεται έλεγχος αν η ποσότητα που επιθυμεί ο χρήστης υπερβαίνει την διαθέσιμη ποσότητα του συστήματος για αυτό το προϊόν και σε αυτήν την περίπτωση εμφανίζεται μήνυμα "We don not have that much stock".
  
#### Εμφάνιση καλαθιού
Ο χρήστης για να δει το καλάθι του θα πρέπει να επισκεφθεί την διεύθυνση http://127.0.0.1:5000/uuid/showCart (όπου uuid είναι το uuid που του έδωσε το σύστημα όταν συνδέθηκε) και θα του εμφανίζονται όλα τα προϊόντα που έχει προσθέσει μαζί με την συνολική τιμή τους αν έχει προσθέσει προϊόντα, ενώ αν δεν έχει προσθέσει θα του εμφανίζεται μήνυμα "You have not added anything to cart yet".
  
#### Διαγραφή προϊόντος από το καλάθι
Ο χρήστης για να αφαιρέσει κάποιο προϊόν από το καλάθι του θα πρέπει να επισκεφθεί την διεύθυνση http://127.0.0.1:5000/uuid/deleteFromCart/id (όπου uuid είναι το uuid που του έδωσε το σύστημα όταν συνδέθηκε και id είναι ο μοναδικός κωδικός του προϊόντος) και αν υπήρχε όντως αυτό το προϊόν στο καλάθι του τότε θα αφαιρεθεί και θα εμφανιστεί στον χρήστη το ανανεωμένο καλάθι του. Όμως, αν δεν υπήρχε θα του εμφανιστεί μήνυμα "No product found with that id in cart".
  
#### Αγορά προϊόντων
Ο χρήστης για να αγοράσει τα προϊόντα που έχει προσθέσει στο καλάθι του θα πρέπει να επισκεφθεί την διεύθυνση http://127.0.0.1:5000/uuid/buyProducts (όπου uuid είναι το uuid που του έδωσε το σύστημα όταν συνδέθηκε) και θα του εμφανίζεται μια φόρμα όπου θα του ζητείται ο 16ψήφιος αριθμός της κάρτας του. Γίνεται έλεγχος αν είναι όντως 16 ψηφία και του εμφανίζεται η απόδειξη αγοράς με όλα τα προϊόντα που είχε προσθέσει στο καλάθι μέχρι και εκείνη την στιγμή. Αν ο αριθμός της κάρτας του δεν είναι ακριβώς 16 ψηφία, του εμφανίζεται μήνυμα "Card number must contain 16 numbers", ενώ αν δεν έχει προσθέσει κανένα προϊόν στο καλάθι του, του εμφανίζεται μήνυμα "Cart is empty".
  
#### Εμφάνιση ιστορικού παραγγελιών του συγκεκριμένου χρήστη
Ο χρήστης για να δει όλες τις παραγγελίες που έχει πραγματοποιήσει στο σύστημα θα πρέπει να επισκεφθεί την διεύθυνση http://127.0.0.1:5000/uuid/showOrderHistory (όπου uuid είναι το uuid που του έδωσε το σύστημα όταν συνδέθηκε) και θα του εμφανιστούν όλες οι παραγγελίες διαχωρισμένες η μια από την άλλη. Αν δεν έχει πραγματοποιήσει καμία παραγγελία στο σύστημα, του εμφανίζεται μήνυμα "Order history is empty".
  
#### Διαγραφή του λογαριασμού του
Ο χρήστης για να διαγράψει τον λογαριασμό του από το σύστημα θα πρέπει να επισκεφθεί την διεύθυνση http://127.0.0.1:5000/uuid/deleteUser (όπου uuid είναι το uuid που του έδωσε το σύστημα όταν συνδέθηκε) και όλα τα στοιχεία του θα διαγραφούν. Δεν θα μπορεί πλέον να έχει πρόσβαση στο σύστημα και το uuid που του έδωσε το σύστημα όταν συνδέθηκε δεν θα μπορεί να το ξαναχρησιμοποιήσει.
  
### Λειτουργίες διαχειριστή
#### Είσοδος στο σύστημα
Ο διαχειριστής για να συνδεθεί, θα πρέπει να επισκεφθεί την διεύθυνση http://127.0.0.1:5000/login όπου εκεί θα δει μια φόρμα που θα του ζητούνται email και κωδικός. Αν εισάγει τα στοιχεία του λάθος θα του εμανιστεί μήνυμα "Wrong username or password, please try again", ενώ αν τα εισάγει σωστά, το σύστημα θα του εμφανίσει ένα uuid, το οποίο θα τον βοηθήσει να έχει πρόσβαση σε όλες τις λειτουργίες ενός διαχειριστή. Αν προσπαθήσει με αυτό το uuid να αποκτήσει πρόσβαση σε σελίδα που προορίζεται μόνο για απλούς χρήστες, θα του εμφανιστεί μήνυμα "Only simple users can perform this operation".
  
#### Εισαγωγή νέου προϊόντος
Ο διαχειριστής για να προσθέσει κάποιο προϊόν στο σύστημα θα πρέπει να επισκεφθεί την διεύθυνση http://127.0.0.1:5000/uuid/insertProduct (όπου uuid είναι το uuid που του έδωσε το σύστημα όταν συνδέθηκε) και θα του εμφανίζεται μια φόρμα όπου θα του ζητούνται όλα τα απαραίτητα στοιχεία που πρέπει να περιέχει ένα προϊόν στο σύστημα όπως το όνομά του, την κατηγορία στην οποία ανήκει, το συνολικό πλήθος (απόθεμα) που υπάρχει διαθέσιμο στο κατάστημα προς πώληση (stock), την περιγραφή του, καθώς και την τιμή του. Αν προσθέσει όλα τα στοιχεία του προϊόντος, το προϊόν θα προστεθεί στην βάση δεδομένων του συστήματος και θα του εμφανιστεί μήνυμα "Product was added to the MongoDB".
  
#### Διαγραφή προϊόντος από το σύστημα
Ο διαχειριστής για να αφαιρέσει κάποιο προϊόν από το σύστημα θα πρέπει να επισκεφθεί την διεύθυνση http://127.0.0.1:5000/uuid/removeProduct/id (όπου uuid είναι το uuid που του έδωσε το σύστημα όταν συνδέθηκε και id είναι ο μοναδικός κωδικός του προϊόντος) και αν υπάρχει κάποιο προϊόν στην βάση δεδομένων που περιέχει τον μοναδικό κωδικό που έχει εισάγει ο διαχειριστής, το προϊόν θα διαγράφεται από την βάση δεδομένων. Αν δεν υπάρχει κάποιο προϊόν στην βάση δεδομένων που περιέχει τον μοναδικό κωδικό που έχει εισάγει ο διαχειριστής, τότε θα του εμφανίζεται μήνυμα "No product found with that id".
  
#### Ενημέρωση κάποιου προϊόντος
Ο διαχειριστής για να τροποποιήσει τα στοιχεία κάποιου προϊόντος από το σύστημα θα πρέπει να επισκεφθεί την διεύθυνση http://127.0.0.1:5000/uuid/updateProduct/id (όπου uuid είναι το uuid που του έδωσε το σύστημα όταν συνδέθηκε και id είναι ο μοναδικός κωδικός του προϊόντος) και θα του εμφανίζεται μια φόρμα όπου θα μπορεί να ενημερώσει όποιο στοιχείο του προϊόντος θέλει όπως το όνομά του, την τιμή του, την περιγραφή του, καθώς και το συνολικό πλήθος (απόθεμα) που είναι διαθέσιμο προς πώληση από το κατάστημα (stock). Θα μπορεί αν θέλει να τροποποιήσει ταυτόχρονα παραπάνω από ένα στοιχεία. Αν δεν υπάρχει κάποιο προϊόν στην βάση δεδομένων που περιέχει τον μοναδικό κωδικό που έχει εισάγει ο διαχειριστής, τότε θα του εμφανίζεται μήνυμα "No product found with that id".
  
## MongoDB
Για να χρησιμοποιήσετε το mongo shell εκτελέστε στο terminal αυτήν την εντολή:
* `(sudo) docker exec -it mongodb mongo`

Για να χρησιμοποιήσετε την βάση δεδομένων που έχει υλοποιηθεί για το σύστημα, εκτελέστε αυτήν την εντολή:
* `use DSMarkets`

Για να δείτε όλους του χρήστες που έχουν δημιουργηθεί, εκτελέστε αυτήν την εντολή:
* `db.Users.find({})`

Για να δείτε όλα τα προϊόντα που έχουν δημιουργηθεί, εκτελέστε αυτήν την εντολή:
* `db.Products.find({})`
